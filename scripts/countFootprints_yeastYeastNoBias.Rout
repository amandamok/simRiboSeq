
R version 3.4.4 (2018-03-15) -- "Someone to Lean On"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> rm(list=ls())
> 
> source(file.path("~/simRiboSeq/scripts/helper.R"))
> 
> # read in iXnos cts_by_codon output
> expt <- "yeast_yeastCodons"
> ixnos_cts_filename <- file.path("~/iXnos/expts", paste0(expt, "_noBias"), "process/cts_by_codon.size.27.31.txt")
> ixnos_cts <- readCtsByCodon(ixnos_cts_filename)
> 
> # set up empty counts list
> gene_len <- read.table(file.path("~/iXnos/genome_data/", paste0(expt, "_lengths.txt")),
+                        col.names=c("transcript", "utr5", "cds", "utr3"),
+                        stringsAsFactors=F)
> nGenes <- nrow(gene_len)
> sim_cts <- lapply(gene_len$cds,
+                   function(x) {
+                     rep(0, times=x/3)
+                   })
> names(sim_cts) <- gene_len$transcript
> 
> faFiles_dir <- file.path("~/simRiboSeq/outputs/", paste0(expt, "_uniformDelta_noBias_80Mreads/"))
> faFiles <- list.files(faFiles_dir)
> faFiles <- grep(".fa", faFiles, value=T)
> 
> for(x in faFiles) {
+   print(x)
+   tmp <- readLines(file.path(faFiles_dir, x))
+   nReads <- length(tmp)/2
+   footprints <- data.frame(t(simplify2array(strsplit(tmp[2*(1:nReads)-1], split="_"))),
+                            row.names=NULL,
+                            stringsAsFactors=F)
+   colnames(footprints) <- c("transcript", "Asite", "id")
+   footprints$transcript <- sub(">", "", footprints$transcript)
+   footprints$Asite <- as.numeric(footprints$Asite)
+   for(x in 1:nReads) {
+     sim_cts[[which(names(sim_cts)==footprints$transcript[x])]][footprints$Asite[x]] <- sim_cts[[which(names(sim_cts)==footprints$transcript[x])]][footprints$Asite[x]] + 1
+   }
+   rm(tmp)
+ }
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part1.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part10.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part11.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part12.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part13.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part14.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part15.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part16.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part17.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part18.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part19.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part2.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part20.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part21.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part22.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part23.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part24.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part25.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part26.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part27.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part28.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part29.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part3.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part30.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part31.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part32.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part33.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part34.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part35.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part36.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part37.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part38.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part39.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part4.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part40.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part41.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part42.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part43.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part44.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part45.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part46.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part47.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part48.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part49.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part5.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part50.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part51.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part52.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part53.fa"
[1] "yeast_yeastCodons_uniformDelta_noBias_80Mreads_part54.fa"
Terminated
